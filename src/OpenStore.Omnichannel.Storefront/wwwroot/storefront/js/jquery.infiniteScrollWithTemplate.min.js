!function(e){e.fn.infiniteTemplate=function(t){const l=e(this);if(!l.length)return l;const n=e.extend({},e.fn.infiniteTemplate.defaults,t);let o=n.initialPage,a=!1,r=!1;function c(){if(a||r)return;a=!0;const t=e.templates(n.templateSelector),c=n.query?"&"+n.query:"",i=n.preventCache?"&t="+(new Date).getTime():"";e.ajax({url:n.dataPath+"?page="+o+c+i,method:n.method,beforeSend:function(){n.loaderSelector&&e(n.loaderSelector).show()},complete:function(){n.loaderSelector&&e(n.loaderSelector).hide()},success:function(c){"string"==typeof c&&(c=JSON.parse(c)),c&&(0===c[n.key].length?(r=!0,1===o&&"function"==typeof n.zeroCallback&&n.zeroCallback()):(e.each(c[n.key],function(o,a){n.templateHelpers&&(a=Object.assign(a,n.templateHelpers));const r=t.render(a);e(r.replace(/(\r\n|\n|\r)/gm,"")).appendTo(l)}),o+=1)),a=!1}})}return n.loadSelector?e(document).on("click",n.loadSelector,function(){c()}):e(window).on("scroll",function(){e(this).scrollTop()>e(document.body).height()-2*e(this).height()&&!r&&c()}),n.loadAtStart&&c(),this},e.fn.infiniteTemplate.defaults={dataPath:null,templateSelector:null,query:null,key:"data",method:"GET",templateHelpers:null,loadAtStart:!0,loadSelector:null,initialPage:1,preventCache:!1,zeroCallback:null,loaderSelector:null}}(jQuery);